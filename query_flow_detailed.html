<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semantica - Query Flow Architecture</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0A1929 0%, #1a2332 100%);
            color: #F0F4F8;
            overflow-x: hidden;
        }

        .hero {
            text-align: center;
            padding: 60px 20px 40px;
            position: relative;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(99, 102, 241, 0.2) 0%, transparent 70%);
            pointer-events: none;
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 0.3;
                transform: translateX(-50%) scale(1);
            }

            50% {
                opacity: 0.6;
                transform: translateX(-50%) scale(1.1);
            }
        }

        h1 {
            font-size: 3.5rem;
            background: linear-gradient(135deg, #fff 0%, #6366f1 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            position: relative;
        }

        .tagline {
            font-size: 1.3rem;
            color: #94A3B8;
            margin-bottom: 40px;
        }

        .metrics {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            margin-bottom: 50px;
        }

        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #6366f1;
            display: block;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .query-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 50px;
        }

        .query-btn {
            padding: 14px 28px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            color: #F0F4F8;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .query-btn:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: #6366f1;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.2);
        }

        .query-btn.active {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-color: #6366f1;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
        }

        .flow-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px 60px;
            position: relative;
        }

        /* Animated connection line */
        .flow-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, transparent, #6366f1, transparent);
            transform: translateX(-50%);
            opacity: 0.3;
        }

        .flow-line::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background: linear-gradient(180deg, #6366f1, #8b5cf6);
            animation: flowDown 3s ease-in-out infinite;
        }

        @keyframes flowDown {
            0% {
                transform: translateY(-100%);
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                transform: translateY(100%);
                opacity: 0;
            }
        }

        .phase {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 30px;
            margin-bottom: 80px;
            align-items: center;
            position: relative;
            animation: fadeInUp 0.6s ease backwards;
        }

        .phase:nth-child(odd) .phase-content {
            order: 1;
            text-align: right;
        }

        .phase:nth-child(odd) .phase-icon {
            order: 2;
        }

        .phase:nth-child(odd) .phase-visual {
            order: 3;
        }

        .phase:nth-child(even) .phase-visual {
            order: 1;
        }

        .phase:nth-child(even) .phase-icon {
            order: 2;
        }

        .phase:nth-child(even) .phase-content {
            order: 3;
            text-align: left;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .phase-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.4);
            position: relative;
            z-index: 2;
            animation: iconFloat 3s ease-in-out infinite;
        }

        @keyframes iconFloat {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .phase-content {
            padding: 30px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .phase-number {
            display: inline-block;
            background: rgba(99, 102, 241, 0.2);
            color: #6366f1;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .phase-title {
            font-size: 1.6rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 12px;
        }

        .phase-desc {
            color: #94A3B8;
            line-height: 1.7;
            margin-bottom: 15px;
        }

        .phase-tech {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: var(--tech-justify, flex-start);
        }

        .phase:nth-child(odd) {
            --tech-justify: flex-end;
        }

        .tech-tag {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 500;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .phase-visual {
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .visual-code {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #10b981;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: left;
            width: 100%;
        }

        .visual-diagram {
            width: 100%;
            text-align: center;
            color: #64748b;
        }

        .visual-diagram svg {
            max-width: 100%;
            height: auto;
        }

        .summary {
            max-width: 900px;
            margin: 80px auto 0;
            padding: 40px;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 20px;
            text-align: center;
        }

        .summary h2 {
            font-size: 2rem;
            color: #fff;
            margin-bottom: 20px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .stat {
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #6366f1;
            display: block;
            margin-bottom: 8px;
        }

        .stat-label {
            color: #94A3B8;
            font-size: 0.95rem;
        }

        @media (max-width: 968px) {
            .phase {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .phase:nth-child(odd) .phase-content,
            .phase:nth-child(even) .phase-content {
                order: 2;
                text-align: left;
            }

            .phase:nth-child(odd) .phase-icon,
            .phase:nth-child(even) .phase-icon {
                order: 1;
                margin: 0 auto;
            }

            .phase:nth-child(odd) .phase-visual,
            .phase:nth-child(even) .phase-visual {
                order: 3;
            }

            .phase:nth-child(odd) {
                --tech-justify: flex-start;
            }

            .flow-line {
                display: none;
            }

            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>

<body>

    <div style="max-width: 1400px; margin: 0 auto; padding: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <a href="zero_cost_db_connections.html"
                style="text-decoration: none; color: #94A3B8; font-size: 0.9rem; transition: color 0.3s;">‚Üê Prev:
                Zero-Cost Strategies</a>
            <a href="data_architecture.html"
                style="text-decoration: none; color: #94A3B8; font-size: 0.9rem; transition: color 0.3s;">Next: Data
                Architecture ‚Üí</a>
        </div>
    </div>
    <div class="hero">
        <h1>‚ö° Query Flow Architecture</h1>
        <p class="tagline">Natural Language ‚Üí Multi-Agent AI ‚Üí Real-Time Insights</p>

        <div class="metrics">
            <div class="metric">
                <span class="metric-value" id="avgTime">1.8s</span>
                <span class="metric-label">Avg Response Time</span>
            </div>
            <div class="metric">
                <span class="metric-value" id="avgCost">‚Çπ3.48</span>
                <span class="metric-label">Cost Per Query</span>
            </div>
            <div class="metric">
                <span class="metric-value" id="accuracy">96%</span>
                <span class="metric-label">SQL Accuracy</span>
            </div>
        </div>

        <div class="query-selector">
            <button class="query-btn active" data-type="simple">Simple Query</button>
            <button class="query-btn" data-type="complex">Complex Analytics</button>
            <button class="query-btn" data-type="forecast">ML Forecasting</button>
        </div>
    </div>

    <div class="flow-container">
        <div class="flow-line"></div>
        <div id="flowSteps"></div>
    </div>

    <script>
        const flows = {
            simple: {
                example: '"Show all active users"',
                time: '1.8s',
                cost: '‚Çπ0.08',
                accuracy: '96%',
                phases: [
                    {
                        icon: 'üë§',
                        title: 'User Input',
                        desc: 'Natural language query captured via web interface. No SQL knowledge required.',
                        tech: ['Next.js', 'WebSocket', 'JWT Auth'],
                        visual: `POST /api/v1/query
{ 
  "query": "Show all active users",
  "sessionId": "xyz123"
}`
                    },
                    {
                        icon: 'üõ°Ô∏è',
                        title: 'Security Gateway',
                        desc: 'Multi-layer authentication, rate limiting (100 req/min), and prompt injection firewall. All checks complete in under 30ms.',
                        tech: ['Redis', 'JWT', 'OWASP'],
                        visual: `‚úì JWT Token Valid
‚úì Rate Limit: 12/100
‚úì No SQL Injection
‚Üí Request Approved`
                    },
                    {
                        icon: 'üß†',
                        title: 'AI Supervisor',
                        desc: 'LangGraph agent analyzes intent, identifies relevant tables, and routes to specialized agents. Uses Claude 3.5 Sonnet for complex reasoning.',
                        tech: ['LangGraph', 'Claude 3.5', 'Vector Search'],
                        visual: `Intent: SIMPLE_SELECT
Tables: [users]
Route: SQL_AGENT
Complexity: LOW (2/10)`
                    },
                    {
                        icon: '‚öôÔ∏è',
                        title: 'SQL Generation',
                        desc: 'Intelligent model routing: simple queries use Groq Llama (70% cheaper), complex ones use GPT-4o. Schema-aware SQL generation with validation.',
                        tech: ['Groq Llama 3', 'Schema Cache', 'Cost Router'],
                        visual: `SELECT id, name, email
FROM users
WHERE status = 'active'
LIMIT 10000;`
                    },
                    {
                        icon: 'üîç',
                        title: 'Validation',
                        desc: 'Security validator blocks dangerous operations. Schema validator ensures correctness. Query cost estimator prevents expensive operations.',
                        tech: ['AST Parser', 'EXPLAIN Plan', 'Row Limiter'],
                        visual: `‚úì No DELETE/DROP
‚úì Columns exist
‚úì Row limit enforced
‚úì Est. time: 45ms`
                    },
                    {
                        icon: 'üíæ',
                        title: 'Database Execution',
                        desc: 'Secure read-only connection to customer database. Credentials encrypted with AES-256. Results streamed to memory, never written to disk.',
                        tech: ['PostgreSQL', 'HashiCorp Vault', 'Connection Pool'],
                        visual: `Connecting to customer DB...
Executing query...
‚Üí 847 rows returned
‚Üí 120ms execution time`
                    },
                    {
                        icon: 'üìä',
                        title: 'Smart Formatting',
                        desc: 'Visualization Agent analyzes data structure and automatically selects optimal output format (table, chart, summary).',
                        tech: ['Plotly.js', 'PDF Gen', 'Excel Export'],
                        visual: `Data Type: List
Best Format: Table
Exports: CSV, Excel, PDF
‚Üí Rendering...`
                    },
                    {
                        icon: '‚ú®',
                        title: 'Delivery',
                        desc: 'Real-time streaming via WebSocket. Multiple export formats generated simultaneously. Results are shareable with access controls.',
                        tech: ['WebSocket', 'React', 'Access Control'],
                        visual: `‚Üí Interactive Table
‚Üí CSV Download
‚Üí Share Link
‚Üí Add to Dashboard`
                    }
                ]
            },
            complex: {
                example: '"Q4 revenue by region with YoY growth"',
                time: '4.8s',
                cost: '‚Çπ0.65',
                accuracy: '94%',
                phases: [
                    {
                        icon: 'üë§',
                        title: 'User Input',
                        desc: 'Complex analytical query requiring multi-table JOINs and time-series comparison.',
                        tech: ['Next.js', 'WebSocket'],
                        visual: `POST /api/v1/query
{ 
  "query": "Q4 revenue by region 
   with YoY growth"
}`
                    },
                    {
                        icon: 'üõ°Ô∏è',
                        title: 'Security Gateway',
                        desc: 'All security checks passed in under 30ms.',
                        tech: ['Redis', 'JWT'],
                        visual: `‚úì Authentication
‚úì Rate Limiting
‚úì Prompt Firewall`
                    },
                    {
                        icon: 'üß†',
                        title: 'AI Supervisor',
                        desc: 'Detects high complexity (8/10). Identifies ambiguous terms ("revenue") and requests clarification from user.',
                        tech: ['LangGraph', 'Claude 3.5'],
                        visual: `Intent: ANALYTICAL
Complexity: HIGH (8/10)
Ambiguity: "revenue"
‚Üí User clarifies: Net Revenue`
                    },
                    {
                        icon: '‚öôÔ∏è',
                        title: 'SQL Generation',
                        desc: 'Routes to GPT-4o for advanced reasoning. Generates multi-CTE query with year-over-year calculations across 3 tables.',
                        tech: ['GPT-4o', 'Multi-table JOIN'],
                        visual: `WITH q4_2025 AS (...)
SELECT 
  region,
  revenue_2025,
  revenue_2024,
  YoY_growth_pct
FROM q4_2025 a
JOIN q4_2024 b...`
                    },
                    {
                        icon: 'üîç',
                        title: 'Enhanced Validation',
                        desc: 'Multi-layer validation plus LLM-powered intent alignment check to ensure SQL matches question.',
                        tech: ['AST Parser', 'Intent Verifier'],
                        visual: `‚úì Security checks
‚úì Schema valid
‚úì JOIN correctness
‚úì Intent aligned`
                    },
                    {
                        icon: 'üíæ',
                        title: 'Database Execution',
                        desc: 'Complex query with JOINs and aggregations. Scans 45K rows, returns 8 regions in 850ms.',
                        tech: ['PostgreSQL', 'Query Optimizer'],
                        visual: `Rows scanned: 45,678
Rows returned: 8
Execution: 850ms
‚úì Success`
                    },
                    {
                        icon: 'üìä',
                        title: 'AI Analysis + Viz',
                        desc: 'Business Analyst Agent generates strategic insights. Viz Agent creates bar chart, trend line, and executive summary.',
                        tech: ['Claude 3.5', 'Plotly.js', 'Report Gen'],
                        visual: `Insights:
‚Ä¢ North America: +45% YoY üöÄ
‚Ä¢ Europe: -8% YoY ‚ö†Ô∏è
‚Ä¢ Total Q4: $12.4M (+15%)`
                    },
                    {
                        icon: '‚ú®',
                        title: 'Multi-Format Output',
                        desc: 'Generates 7+ formats simultaneously: charts, table, summary, PowerPoint, PDF, CSV, and shareable link.',
                        tech: ['Plotly', 'Export Suite', 'Access Control'],
                        visual: `‚úì Bar Chart
‚úì Trend Line
‚úì Data Table
‚úì PowerPoint Slide
‚úì PDF Report`
                    }
                ]
            },
            forecast: {
                example: '"Predict next month sales with 95% CI"',
                time: '12s',
                cost: '‚Çπ0.75',
                accuracy: '89%',
                phases: [
                    {
                        icon: 'üë§',
                        title: 'User Input',
                        desc: 'Advanced statistical forecasting request requiring machine learning.',
                        tech: ['Next.js', 'WebSocket'],
                        visual: `POST /api/v1/query
{ 
  "query": "Predict next month 
   sales with 95% confidence"
}`
                    },
                    {
                        icon: 'üõ°Ô∏è',
                        title: 'Security Gateway',
                        desc: 'Standard security pipeline.',
                        tech: ['Redis', 'JWT'],
                        visual: `‚úì All checks passed
‚Üí 30ms`
                    },
                    {
                        icon: 'üß†',
                        title: 'AI Supervisor',
                        desc: 'Detects predictive analytics intent. Routes to Data Scientist Agent. Verifies Python sandbox availability.',
                        tech: ['LangGraph', 'Claude 3.5'],
                        visual: `Intent: FORECASTING
Route: DATA_SCI_AGENT
Complexity: VERY_HIGH (9/10)
Sandbox: Ready ‚úì`
                    },
                    {
                        icon: 'üíæ',
                        title: 'Data Extraction',
                        desc: 'SQL Agent first fetches 12 months of historical sales data (365 rows) for model training.',
                        tech: ['PostgreSQL', 'Time-series'],
                        visual: `SELECT date, SUM(amount)
FROM sales
WHERE date >= '2024-01-01'
GROUP BY date
‚Üí 365 rows returned`
                    },
                    {
                        icon: 'ü§ñ',
                        title: 'ML Model Training',
                        desc: 'Data Scientist Agent generates Python code using Facebook Prophet. Executes in isolated E2B sandbox with no network access.',
                        tech: ['GPT-4o', 'Python', 'Prophet', 'E2B Sandbox'],
                        visual: `from prophet import Prophet
model = Prophet(interval=0.95)
model.fit(historical_data)
forecast = model.predict(30)
‚Üí Executed in 8s`
                    },
                    {
                        icon: 'üìà',
                        title: 'Forecast Results',
                        desc: 'Model predicts $485K expected sales with 95% confidence interval: $420K-$550K.',
                        tech: ['Prophet', 'Statistical Analysis'],
                        visual: `Feb 2025 Prediction:
Expected: $485,000
CI Lower: $420,000
CI Upper: $550,000
Confidence: High`
                    },
                    {
                        icon: 'üìä',
                        title: 'Business Insights',
                        desc: 'Business Analyst interprets forecast, identifies risks (wide CI indicates volatility), and suggests actions.',
                        tech: ['Claude 3.5', 'Strategic Analysis'],
                        visual: `Analysis:
‚Ä¢ +8% growth forecast
‚Ä¢ High volatility risk
Actions:
‚Üí Use lower bound ($420K)
‚Üí Plan promotional boost`
                    },
                    {
                        icon: '‚ú®',
                        title: 'Rich Output',
                        desc: 'Generates forecast chart with confidence bands, statistical report, Jupyter notebook for reproducibility, and executive briefing.',
                        tech: ['Plotly', 'PDF', 'Jupyter', 'Report Gen'],
                        visual: `‚úì Forecast Chart + CI
‚úì Statistical Report
‚úì Reproducible Notebook
‚úì Executive Briefing`
                    }
                ]
            }
        };

        function renderFlow(type) {
            const flow = flows[type];
            const container = document.getElementById('flowSteps');

            // Update metrics
            document.getElementById('avgTime').textContent = flow.time;
            document.getElementById('avgCost').textContent = flow.cost;
            document.getElementById('accuracy').textContent = flow.accuracy;

            container.innerHTML = flow.phases.map((phase, idx) => `
        <div class="phase" style="animation-delay: ${idx * 0.1}s">
            <div class="phase-content">
                <span class="phase-number">Step ${idx + 1}</span>
                <h3 class="phase-title">${phase.title}</h3>
                <p class="phase-desc">${phase.desc}</p>
                <div class="phase-tech">
                    ${phase.tech.map(t => `<span class="tech-tag">${t}</span>`).join('')}
                </div>
            </div>
            <div class="phase-icon">${phase.icon}</div>
            <div class="phase-visual">
                <div class="visual-code">${phase.visual}</div>
            </div>
        </div>
    `).join('') + `
        <div class="summary">
            <h2>End-to-End Performance</h2>
            <div class="summary-stats">
                <div class="stat">
                    <span class="stat-value">${flow.time}</span>
                    <span class="stat-label">Total Time</span>
                </div>
                <div class="stat">
                    <span class="stat-value">${flow.cost}</span>
                    <span class="stat-label">Total Cost</span>
                </div>
                <div class="stat">
                    <span class="stat-value">${flow.accuracy}</span>
                    <span class="stat-label">Accuracy</span>
                </div>
                <div class="stat">
                    <span class="stat-value">0</span>
                    <span class="stat-label">Data Stored</span>
                </div>
            </div>
        </div>
    `;
        }

        // Event listeners
        document.querySelectorAll('.query-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.query-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderFlow(btn.dataset.type);
            });
        });

        // Initial render
        renderFlow('simple');
    </script>

</body>

</html>
